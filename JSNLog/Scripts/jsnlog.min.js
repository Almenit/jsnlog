var __extends=this.__extends||function(b,c){function g(){this.constructor=b}for(var f in c)c.hasOwnProperty(f)&&(b[f]=c[f]);g.prototype=c.prototype;b.prototype=new g};function JL(b){if(!b)return JL.__;var c="";return("."+b).split(".").reduce(function(b,f){c=c?c+("."+f):f;var d=b["__"+c];void 0===d&&(JL.Logger.prototype=b,d=new JL.Logger(c),b["__"+c]=d);return d},JL.__)}
(function(b){function c(a,b,c){void 0!==b[a]&&(null===b[a]?delete c[a]:c[a]=b[a])}function g(a){if(null!=b.enabled&&!b.enabled)return!1;try{if(a.userAgentRegex&&!RegExp(a.userAgentRegex).test(navigator.userAgent))return!1}catch(c){}try{if(a.ipRegex&&b.clientIP&&!RegExp(a.ipRegex).test(b.clientIP))return!1}catch(i){}return!0}b.enabled;b.clientIP;b.requestId;b.setOptions=function(a){c("enabled",a,this);c("clientIP",a,this);c("requestId",a,this);return this};b.getAllLevel=function(){return-2147483648};
b.getTraceLevel=function(){return 1E3};b.getDebugLevel=function(){return 2E3};b.getInfoLevel=function(){return 3E3};b.getWarnLevel=function(){return 4E3};b.getErrorLevel=function(){return 5E3};b.getFatalLevel=function(){return 6E3};b.getOffLevel=function(){return 2147483647};var f;f=function(a,b,c,d){this.l=a;this.m=b;this.n=c;this.t=d};b.LogItem=f;var d=function(a,c){this.appenderName=a;this.sendLogItems=c;this.level=b.getTraceLevel();this.sendWithBufferLevel=2147483647;this.storeInBufferLevel=-2147483648;
this.bufferSize=0;this.batchSize=1;this.buffer=[];this.batchBuffer=[]};d.prototype.setOptions=function(a){c("level",a,this);c("ipRegex",a,this);c("userAgentRegex",a,this);c("sendWithBufferLevel",a,this);c("storeInBufferLevel",a,this);c("bufferSize",a,this);c("batchSize",a,this);this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize);return this};d.prototype.log=function(a,b,c){g(this)&&!(a<this.storeInBufferLevel)&&(b=new f(a,b,c,(new Date).getTime()),a<this.level?0<this.bufferSize&&
(this.buffer.push(b),this.buffer.length>this.bufferSize&&this.buffer.shift()):(!(a<this.sendWithBufferLevel)&&this.buffer.length&&(this.batchBuffer=this.batchBuffer.concat(this.buffer),this.buffer.length=0),this.batchBuffer.push(b),this.batchBuffer.length>=this.batchSize&&this.sendBatch()))};d.prototype.sendBatch=function(){0!=this.batchBuffer.length&&(this.sendLogItems(this.batchBuffer),this.batchBuffer.length=0)};b.Appender=d;var j,h=function(a){d.call(this,a,h.prototype.sendLogItemsAjax);this.url=
"jsnlog.logger"};__extends(h,d);h.prototype.setOptions=function(a){c("url",a,this);d.prototype.setOptions.call(this,a);return this};h.prototype.sendLogItemsAjax=function(a){try{var c=JSON.stringify({r:b.requestId,lg:a}),i=new XMLHttpRequest;i.open("POST",this.url);i.setRequestHeader("Content-Type","application/json");i.send(c)}catch(d){}};j=h;b.AjaxAppender=j;var e=function(a){this.loggerName=a;this.seenRegexes=[]};e.prototype.stringifyLogObject=function(a){switch(typeof a){case "string":return a;
case "number":return a.toString();case "boolean":return a.toString();case "undefined":return"undefined";case "function":return a instanceof RegExp?a.toString():this.stringifyLogObject(a());case "object":return a instanceof RegExp||a instanceof String||a instanceof Number||a instanceof Boolean?a.toString():JSON.stringify(a);default:return"unknown"}};e.prototype.setOptions=function(a){c("level",a,this);c("userAgentRegex",a,this);c("ipRegex",a,this);c("appenders",a,this);c("onceOnly",a,this);this.seenRegexes=
[];return this};e.prototype.log=function(a,b){var c=0,d;if(!this.appenders)return this;if(a>=this.level&&g(this)){d=this.stringifyLogObject(b);if(this.onceOnly)for(c=this.onceOnly.length-1;0<=c;){if(RegExp(this.onceOnly[c]).test(d)){if(this.seenRegexes[c])return this;this.seenRegexes[c]=!0}c--}for(c=this.appenders.length-1;0<=c;)this.appenders[c].log(a,d,this.loggerName),c--}return this};e.prototype.trace=function(a){return this.log(1E3,a)};e.prototype.debug=function(a){return this.log(2E3,a)};e.prototype.info=
function(a){return this.log(3E3,a)};e.prototype.warn=function(a){return this.log(4E3,a)};e.prototype.error=function(a){return this.log(5E3,a)};e.prototype.fatal=function(a){return this.log(6E3,a)};b.Logger=e;e=new j("");b.__=new b.Logger("");b.__.setOptions({level:b.getDebugLevel(),appenders:[e]});b.createAjaxAppender=function(a){return new j(a)}})(JL||(JL={}));
